<sonub-header></sonub-header>
<section class="content">
  <sonub-left *ngIf=" app.size == 'big' "></sonub-left>
  <section class="center">

    <div class="post-list-menu">
      <div *ngIf="post_name" class="post-name">{{ post_name }}</div>
      <div class="new-post" (click)="onClickPostCreate()">New Post</div>
    </div>
    <!-- create a  post -->
    <edit-component *ngIf = " showPostCreateFrom "
                    [mode]    = " 'create-post' "
                    [active]  = " true "
                    [post_id] = " post_id "
                    [posts]   = " posts "
                    (error)   = " OnEditComponentError( $event ) "
                    (cancel)  = " OnEditComponentCancel() "
                    (success) = " OnEditComponentSuccess() "
    ></edit-component>
    <hr>
    <div *ngIf=" view " class="view">

      <view-component
        [login_id] = " login?.id "
        [post]="view"
        [root]="view"
        [show]="true"
        [mode] = " 'create-comment' "
        (edit) = " onEditPost( $event ) "
        (error) = " onViewComponentError( $event ) "
      ></view-component>
      <div class="show-more" *ngIf="view?.comments?.length && !view?.more" (click)="view['more'] = true">Show {{ view?.comments?.length }} more comments.</div>
      <div class="comments">
        <ng-container *ngIf=" view?.more ">
          <div class="comment" *ngFor=" let comment of view['comments']; trackBy: comment?.idx;">
            <view-component
              [login_id] = " login?.id "
              [post]="comment" [root]="view"
              [show] = "true"
              [mode] = " 'create-comment' "
              (edit) = " onEditPost( $event ) "
              (error) = " onViewComponentError( $event ) "
            ></view-component>
          </div>
        </ng-container>
        <ng-container *ngIf="view?.last_five_comment">
          <div class="comment" *ngFor=" let comment of view['last_five_comment']; trackBy: comment?.idx;">
            <view-component
              [login_id] = " login?.id "
              [post]="comment" [root]="view"
              [show] = "true"
              [mode] = " 'create-comment' "
              (edit) = " onEditPost( $event ) "
              (error) = " onViewComponentError( $event ) "
            ></view-component>
          </div>
        </ng-container>
      </div><!--/.comments-->
    </div><!--/.view-->


    <div *ngIf=" posts " class="pages posts">
      <div class="post" *ngFor=" let post of posts; let i = index; trackBy: post?.idx ">

        <!-- post_top_ad -->
        <div *ngIf=" post_top_ad && ! (i % limit) " class="post_top_ad">
          <div *ngFor=" let top_ad of post_top_ad " class="top_ad"  routerLink="/article/{{ top_ad.ad_idx }}">
            <div class="image">
              <img [src]="top_ad.src" *ngIf="top_ad?.src">
            </div>
          </div>
        </div><!-- post_top_ad -->

        <!-- post_top_preminum -->
        <div *ngIf=" post_top_premium_ad && ! (i % limit) " class="post_top_premium_ad">
          <div *ngFor=" let premium_ad of post_top_premium_ad " class="top_premium_ad" routerLink="/article/{{ premium_ad.ad_idx }}">
            <div class="image">
              <img [src]="premium_ad.src" *ngIf="premium_ad?.src">
            </div>
            <div class="text">
              <div class="subject">{{ premium_ad.subject }}</div>
              <div class="sub_subject">{{ premium_ad.sub_subject }}</div>
            </div>
          </div>
        </div><!-- post_top_preminum -->

        <!-- ads -->
        <div *ngIf=" ads && ! (i % limit) " class="ads">
          <div *ngFor=" let ad of ads " class="ad" routerLink="/article/{{ ad.idx }}">
            <div class="photo">
              <img [src]="ad.src_thumbnail" *ngIf="ad?.src_thumbnail">
            </div>
            <div class="text">{{ ad.subject }}</div>
          </div>
        </div><!-- ads -->

        <view-component
          [login_id] = " login?.id "
          [post]="post" [root]="post"
          [show]="true"
          [mode] = " 'create-comment' "
          (edit) = " onEditPost( $event ) "
          (error) = " onViewComponentError( $event ) "
        ></view-component>


        <div class="show-more" *ngIf="post?.comments?.length && !post?.more" (click)="post['more'] = true">Show {{ post?.comments?.length }} more comments.</div>
        <div class="comments">
          <ng-container *ngIf=" post?.more ">
            <div class="comment" *ngFor=" let comment of post['comments']; trackBy: comment?.idx;">
              <view-component
                [login_id] = " login?.id "
                [post]="comment" [root]="post"
                [show] = "true"
                [mode] = " 'create-comment' "
                (edit) = " onEditPost( $event ) "
                (error) = " onViewComponentError( $event ) "
              ></view-component>
            </div>
          </ng-container>
          <ng-container *ngIf="post?.last_five_comment">
            <div class="comment" *ngFor=" let comment of post['last_five_comment']; trackBy: comment?.idx;">
              <view-component
                [login_id] = " login?.id "
                [post]="comment" [root]="post"
                [show] = "true"
                [mode] = " 'create-comment' "
                (edit) = " onEditPost( $event ) "
                (error) = " onViewComponentError( $event ) "
              ></view-component>
            </div>
          </ng-container>
        </div><!--/.comments-->
      </div><!--/.post-->

    </div><!--/.posts-->
    <div [attr.active]=" ! noMorePosts " class="in-page-loading"><i class="fa fa-spinner fa-spin"></i> Loading ...</div>
    <div [attr.active]=" noMorePosts " class="no-more-posts">No more posts</div>

  </section><!--/.center-->
  <sonub-right *ngIf=" app.size == 'big' "></sonub-right>
</section><!--/section.content-->
